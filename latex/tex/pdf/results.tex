\section{Implementation and Results}%
\label{sec:pdf_results}

The considerations of \cref{sec:pdf_basics,sec:lab_xs} can
now be applied to obtain a cross section and histograms of observables
for the scattering of two protons into two photons. Because the PDF is
not available in closed form, event generation is the only viable way
to verify theory against experiment, even in this simple leading-order
process.

The integrand in \cref{eq:pdf-xs} can be concretised
into \cref{eq:weighteddist}, where \(q\) runs over all quarks (except
the top quark). The sum has been symmetized, otherwise a double sum
with \(q\) and \(\bar{q}\) would have been necessary. The choice of
\(Q^2\) was explained in \cref{sec:pdf_basics} and is being given
in \cref{eq:q2-explicit}.

\begin{gather}
  \label{eq:weighteddist}
  \frac{\dd[3]{\sigma}}{\dd{\eta}\dd{x_1}\dd{x_2}} =
  \sum_q \qty[f_q\qty(x_1;Q^2) f_{\bar{q}}\qty(x_2;Q^2) + f_q\qty(x_2;Q^2) f_{\bar{q}}\qty(x_1;Q^2)] \dv{\sigma(x_1,
    x_2, Z_q)}{\eta} \\
  \label{eq:q2-explicit}
  Q^2 = 2x_1x_2E_p^2
\end{gather}

This distribution can now be integrated to obtain a total
cross-section as described in \cref{sec:mcint}. Sampling a
multi-dimensional distribution can be reduced to the sampling of one
dimensional distributions by reducing the distribution itself to one
variable through integration over the remaining ones and then, keeping
the first variable fixed, sampling the other variables in a likewise
manner. The hit-or-miss method described in \cref{sec:hitmiss} has to
be modified only in so far as to choose the sampling points in an
\(n\)-dimensional volume. As before, the range of the \(\eta\)
parameter has to be constrained to obtain physical results. Because
the absolute values of the pseudo rapidities of the two final state
photons are not equal in the lab frame, the shape of the
integration/sampling volume differs from a simple
hypercube \(\Omega\). Furthermore, for the massless limit to be applicable the
center of mass energy of the partonic system must be much greater than
the quark masses. This can be implemented by demanding the
transverse momentum \(p_T\) of a final state photon to be greater than
approximately~\SI{20}{\giga\electronvolt}. A restriction (cut) on
\(p_T\) is suitable because detectors are usually only sensitive above
a certain \(p_T\) threshold. %TODO CITE%
Such cuts can be implemented simply by multiplying the distribution
in \cref{eq:weighteddist} by the characteristic function
\(\chi_\Omega\) of \(\Omega\) which is equal to one if \(x\in\Omega\)
and zero otherwise.

The PDF being used in the following has been determined at leading
order and is the central member of the PDF set
\verb|NNPDF31_lo_as_0118| provided by \emph{NNPDF} collaboration and
accessed through the \lhapdf\
library\cite{NNPDF:2017pd}\cite{Buckley:2015lh}.
% TODO clean separation of pdf, pdf set %

The resulting distribution (without cuts) is depicted
in \cref{fig:dist-pdf} for fixed \(x_2\) and
in \cref{fig:dist-pdf-fixed-eta} for fixed \(\eta\).

\begin{figure}[hb]
  \centering
  \plot{pdf/dist3d_x2_const}
  \caption{\label{fig:dist-pdf}Differential cross section convolved
    with PDFs for fixed \protect \result{xs/python/pdf/second_x} in
    picobarn.}
\end{figure}

For \(x_1 = x_2\) the distribution retains some likeness with the
partonic distribution (see \cref{fig:xs-int-eta}) but gets suppressed
for greater values of \(x_1\). The overall shape of the distribution
is clearly highly sub-optimal for hit-or-miss sampling, only having
significant values when \(x_1\) or \(x_2\) are small and being very
steep. To remedy that, one has to use a more efficient sampling
algorithm (\vegas) or impose very restrictive cuts. The \vegas\
algorithm can be adapted to \(n\) dimensions by using a grid of
hypercubes instead of intervals and using the algorithm along each
axis with a slightly altered weighting
mechanism~\cite[197]{Lepage:19781an}. The self-coded implementation
used here can be found in \cref{sec:pycode}.

\begin{figure}[hb]
  \centering
  \plot{pdf/dist3d_eta_const}
  \caption{\label{fig:dist-pdf-fixed-eta}Differential cross section
    convolved with PDFs for fixed \protect
    \result{xs/python/pdf/plot_eta} in picobarn.}
\end{figure}

For the numeric analysis a proton beam energy of
\result{xs/python/pdf/e_proton} has been chosen, in accordance to
\lhc{} beam energies. As for the cuts, \result{xs/python/pdf/eta} and
\result{xs/python/pdf/min_pT} have been set.
Integrating \cref{eq:weighteddist} with respect to those cuts yields
\result{xs/python/pdf/my_sigma} which is compatible with
\result{xs/python/pdf/sherpa_sigma}, the value \sherpa\ gives.  A
sample of \result{xs/python/pdf/sample_size} events has been generated
both in \sherpa\ and through own code. The resulting histograms of
some observables are depicted in \cref{fig:pdf-histos}. The
distributions are largely compatible with each other although there
discrepancies arise in regions with low event count (statistics),
which the the ratio plot exaggerators. The sherpa runcard utilized
here and the analysis used to produce the histograms can be found
in \cref{sec:ppruncard,sec:ppanalysis}. When
comparing \cref{fig:pdf-eta} with \cref{fig:histeta} it becomes
apparent, that the PDF has substantial influence on the resulting
distribution.

\begin{figure}[hp]
  \centering
  \begin{subfigure}{.49\textwidth}
    \centering \plot{pdf/eta_hist}
    \caption{\label{fig:pdf-eta} Histogram of the \(\eta\)
      distribution.}
  \end{subfigure}
  \begin{subfigure}{.49\textwidth}
    \centering \plot{pdf/pt_hist}
    \caption{\label{fig:pdf-pt} Histogram of the \(\pt\)
      distribution.}
  \end{subfigure}
  \begin{subfigure}{.49\textwidth}
    \centering \plot{pdf/cos_theta_hist}
    \caption{\label{fig:pdf-cos-theta} Histogram of the \(\cos\theta\)
      distribution.}
  \end{subfigure}
  \begin{subfigure}{.49\textwidth}
    \centering \plot{pdf/inv_m_hist}
    \caption[Histogram of the invariant mass of the final state photon
    system.]{\label{fig:pdf-inv-m} Histogram of the invariant mass of the
      final state photon system. % This is equal to the center of mass
      % energy of the partonic system before the scattering.
    }
  \end{subfigure}
  \caption{\label{fig:pdf-histos}Comparison of histograms of
    observables for \(\ppgg\) generated manually and by
    \sherpa/\rivet. The sample size was \protect
    \result{xs/python/pdf/sample_size}.}
\end{figure}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../../document"
%%% End:
